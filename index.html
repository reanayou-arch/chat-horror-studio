<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Horror Studio</title>

<style>
body{margin:0;font-family:system-ui;background:#0b1220;color:#fff}
.app{max-width:420px;margin:auto;height:100vh;display:flex;flex-direction:column}
.header{padding:16px;font-size:20px;font-weight:700;background:#020617}
.screen{flex:1;padding:16px;overflow-y:auto}
.card{background:#111827;padding:14px;border-radius:14px;margin-bottom:12px}
input{width:100%;padding:10px;border-radius:12px;border:none;margin-top:6px}
button{margin-top:10px;width:100%;padding:12px;border:none;border-radius:14px;background:#2563eb;color:white;font-size:15px}
.chat{display:flex;flex-direction:column;gap:12px}
.message{display:flex;gap:8px}
.avatar{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700}
.bubble{background:#1f2937;padding:10px 14px;border-radius:16px;max-width:75%}
.name{font-size:12px;opacity:.7;margin-bottom:4px}
.player{justify-content:flex-end}
.player .bubble{background:#22c55e}
.typing{opacity:.5;font-size:13px}
</style>
</head>

<body>
<div class="app">
  <div class="header">Chat Horror Studio</div>
  <div class="screen" id="screen"></div>
</div>

<script>
let –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ = [];
let —Ä–µ–∂–∏–º = "editor";

/* === –†–ï–ù–î–ï–† –ü–ê–ù–ï–õ–ò –ê–í–¢–û–†–ê === */
function showEditor(){
  —Ä–µ–∂–∏–º="editor";
  screen.innerHTML=`
    <div class="card">
      <h3>üìñ –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</h3>
      <input id="storyTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏">
    </div>

    <div class="card">
      <h3>üë• –ü–µ—Ä—Å–æ–Ω–∞–∂–∏</h3>

      <input id="charName" placeholder="–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞">
      <input id="charRole" placeholder="–•–∞—Ä–∞–∫—Ç–µ—Ä (—Å—Ç–µ—Ä–≤–∞, –º–∞—á–æ...)">

      <button onclick="addChar()">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>

      <div id="charList"></div>
    </div>

    <button onclick="startGame()">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç</button>
  `;
  renderCharList();
}

/* === –î–û–ë–ê–í–ò–¢–¨ –ü–ï–†–°–û–ù–ê–ñ–ê === */
function addChar(){
  const name=document.getElementById("charName").value.trim();
  const role=document.getElementById("charRole").value.trim();
  if(!name||!role) return alert("–ó–∞–ø–æ–ª–Ω–∏ –∏–º—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä");

  –ø–µ—Ä—Å–æ–Ω–∞–∂–∏.push({
    name,
    role,
    color: randomColor(),
    memory:[]
  });

  document.getElementById("charName").value="";
  document.getElementById("charRole").value="";
  renderCharList();
}

/* === –°–ü–ò–°–û–ö –ü–ï–†–°–û–ù–ê–ñ–ï–ô === */
function renderCharList(){
  const list=document.getElementById("charList");
  if(!list) return;
  list.innerHTML=–ø–µ—Ä—Å–æ–Ω–∞–∂–∏.map(p=>`
    <div style="margin-top:8px">
      <b>${p.name}</b> ‚Äî <small>${p.role}</small>
    </div>
  `).join("");
}

/* === –ó–ê–ü–£–°–ö –ò–ì–†–´ === */
function startGame(){
  if(–ø–µ—Ä—Å–æ–Ω–∞–∂–∏.length<1) return alert("–î–æ–±–∞–≤—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞");

  —Ä–µ–∂–∏–º="game";
  screen.innerHTML=`
    <button onclick="showEditor()">‚Üê –ù–∞–∑–∞–¥</button>
    <div class="chat" id="chat"></div>

    <div style="display:flex;gap:6px;margin-top:12px">
      <input id="msg" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex:1">
      <button onclick="send()" style="width:auto">‚ñ∂</button>
    </div>
  `;

  addMessage("–°–∏—Å—Ç–µ–º–∞","–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∞–ª–∞—Å—å...", "#444");

  autoStart();
}

/* === –°–û–û–ë–©–ï–ù–ò–Ø === */
function addMessage(name,text,color,isPlayer=false){
  const chat=document.getElementById("chat");
  chat.innerHTML+=`
    <div class="message ${isPlayer?"player":""}">
      ${isPlayer?"":`<div class="avatar" style="background:${color}">${name[0]}</div>`}
      <div class="bubble">
        <div class="name">${name}</div>
        ${text}
      </div>
    </div>
  `;
  chat.scrollTop=99999;
}

/* === –ò–ì–†–û–ö === */
function send(){
  const input=document.getElementById("msg");
  const text=input.value.trim();
  if(!text) return;
  input.value="";
  addMessage("–í—ã",text,"",true);

  react(text);
}

/* === –†–ï–ê–ö–¶–ò–Ø –ü–ï–†–°–û–ù–ê–ñ–ï–ô === */
function react(text){
  const p=–ø–µ—Ä—Å–æ–Ω–∞–∂–∏[Math.floor(Math.random()*–ø–µ—Ä—Å–æ–Ω–∞–∂–∏.length)];

  typing(p.name,()=>{
    let reply="...";

    if(p.role.includes("—Å—Ç–µ—Ä–≤–∞")){
      reply="–û–π, –Ω—É –∫–æ–Ω–µ—á–Ω–æ. –ö–∞–∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ üôÑ";
    }
    else if(p.role.includes("–º–∞—á–æ")){
      reply="–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ... —è —Ö–æ—á—É —É–∑–Ω–∞—Ç—å —Ç–µ–±—è –±–ª–∏–∂–µ üòè";
    }
    else{
      reply="–Ø —Å–ª—É—à–∞—é —Ç–µ–±—è...";
    }

    addMessage(p.name,reply,p.color);
  });
}

/* === –ü–ï–ß–ê–¢–ê–ï–¢ === */
function typing(name,cb){
  const chat=document.getElementById("chat");
  const t=document.createElement("div");
  t.className="typing";
  t.innerText=name+" –ø–µ—á–∞—Ç–∞–µ—Ç...";
  chat.appendChild(t);

  setTimeout(()=>{
    t.remove();
    cb();
  },1200+Math.random()*1500);
}

/* === –ê–í–¢–û–°–¢–ê–†–¢ === */
function autoStart(){
  setTimeout(()=>{
    const p=–ø–µ—Ä—Å–æ–Ω–∞–∂–∏[0];
    addMessage(p.name,"–ù—É –ø—Ä–∏–≤–µ—Ç... —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å –¥–µ–ª–∞–µ—à—å?",p.color);
  },2000);
}

/* === –¶–í–ï–¢ === */
function randomColor(){
  const colors=["#e11d48","#2563eb","#22c55e","#a855f7","#eab308"];
  return colors[Math.floor(Math.random()*colors.length)];
}

const screen=document.getElementById("screen");
showEditor();
</script>

</body>
</html>
